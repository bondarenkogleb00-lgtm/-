описание работы алгортма:
1. Начальная конфигурация
Алгоритм генерирует исходное решение — случайную перестановку городов:
current = случайный маршрут
current_cost = длина маршрута
Также фиксируются:
начальная температура T
коэффициент охлаждения α
количество итераций на одной температуре N
2. Генерация соседнего решения (2-opt)
Для поиска соседних маршрутов используется оператор 2-opt, который:
выбирает два индекса i и j
переворачивает подмаршрут между ними
пример:
до:
A - B - C - D - E
после 2-opt между B и D:
A - D - C - B - E
2-opt — одно из самых эффективных локальных преобразований для TSP, так как убирает пересечения и сокращает путь.
 3. Правило принятия нового решения
Для нового маршрута вычисляется стоимость:
candidate_cost = длина(2-opt(current))
Далее алгоритм решает, принимать его или нет:
Если кандидат лучше (меньше длина) — принимаем всегда
if candidate_cost < current_cost:
 принимаем
Если хуже — принимаем с вероятностью
P=e−ΔT,Δ=candidate_cost−current_cost
P=e − TΔ,Δ=candidate_cost−current_cost
Это ключевое отличие SA от жадного алгоритма:
при высокой температуре допускается принятие худших решений
это помогает "выпрыгивать" из локальных минимумов
 4. Охлаждение температуры
После выполнения заданного числа итераций при текущей температуре используется схема:
T=α⋅T
где
α∈(0.8, 0.99)
α∈(0.8,0.99) — коэффициент охлаждения.
Температура постепенно стремится к нулю, и вероятность принятия худших решений уменьшается.
 5. Запоминание лучшего решения
Алгоритм хранит:
текущее решение current
глобально лучшее решение best
Каждый раз, когда находится более короткий маршрут, он обновляет best.
6. Критерий останова
Работа продолжается, пока:
T>Tmin или пока не исчерпано число итераций.


Анализ временной сложности
Пусть:

n — количество городов

k — количество температур (охлаждений)

m — число итераций на одной температуре (например, 200)
На каждом шаге SA:
1. Генерация 2-opt
Сложность:
O(n)
нужно развернуть часть массива.
2. Вычисление длины маршрута
Если считаем длину заново — это:

O(n)
3. Проверка вероятности принятия

O(1)

 Одна итерация SA

O(n)
Итерации при одной температуре

O(mn)
Полный алгоритм при k температурах

O(kmn)

контрольный вопрос 7


 Доказательство

Рассмотрим машину (M), которая в окончательном расписании жадного алгоритма завершает работу последней; её загрузка равна (Cmax). Пусть на этой машине последней была назначена работа (j) с длительностью (p_j). Тогда до назначения работы (j) загрузка этой машины была равна (Cmax-p_j).

Когда алгоритм выбирал машину для работы (j), он помещал её на машину с минимальной текущей загрузкой. Следовательно в момент назначения работы (j) все (m) машин имели загрузку не меньше, чем (Cmax-p_j). Значит суммарная уже назначенная работа (без учёта (j)) не меньше

m,(Cmax-p_j).


С другой стороны, суммарная уже назначенная работа (без (j)) не превосходит (P-p_j). Поэтому

m,(Cmax-p_j) P - p_j

и значит

Cmax/P-p_j_m + p_j = P/m + 1- 1/m.





